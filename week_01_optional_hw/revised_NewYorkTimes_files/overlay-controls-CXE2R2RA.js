import{D as h,_ as l,e as o,c as Q,u as W,A as c,d as X,y as Y,q as R,k as Z}from"./betamax-shared-CtfXo_g9.js";import{s as $,S as ee}from"./scrubber-Fc2JH2_k.js";import{S as y}from"./event-types-CFKw-uz_.js";import{u as te}from"./keyboard-controls-C1fzEZi7.js";import{u as ae}from"./reduced-motion-BAaHUNZW.js";import{a as ne}from"./index-B-FVqW3A.js";import{u as le}from"./use-share-3HiF_dHL.js";const se="_container_14ryx_13",re="_hide_14ryx_21",oe="_no-click-container_14ryx_26",ue="_controls_14ryx_36",ie="_disableMarginBottom_14ryx_49",ce="_disableMarginRight_14ryx_53",de="_large_14ryx_57",pe="_vertical-video-controls_14ryx_62",_e="_play-button-container_14ryx_67",ye="_paused_14ryx_99",fe="_active_14ryx_121",me="_center-tooltip_14ryx_141",ve="_play-button-inner_14ryx_165",be="_play-button_14ryx_67",ge="_duration_14ryx_190",Ce="_icon_14ryx_199",he="_muted_14ryx_206",Se="_unmuted_14ryx_210",ke="_fullscreen_14ryx_214",Pe="_fullscreen-exit_14ryx_218",Ee="_transcript_14ryx_222",Be="_captions_14ryx_226",Fe="_captions-filled_14ryx_230",Me="_close_14ryx_234",Ne="_link_14ryx_238",we="_caret-up_14ryx_244",De="_caret-down_14ryx_250",Re="_play_14ryx_67",Te="_pause_14ryx_99",Ie="_invisibleFade_14ryx_271",n={container:se,hide:re,noClickContainer:oe,controls:ue,disableMarginBottom:ie,disableMarginRight:ce,large:de,verticalVideoControls:pe,playButtonContainer:_e,paused:ye,active:fe,centerTooltip:me,playButtonInner:ve,playButton:be,duration:ge,icon:Ce,muted:he,unmuted:Se,fullscreen:ke,fullscreenExit:Pe,transcript:Ee,captions:Be,captionsFilled:Fe,close:Me,link:Ne,caretUp:we,caretDown:De,play:Re,pause:Te,invisibleFade:Ie},Ue=h((e,a)=>l("button",{onClick:e.onClick,"aria-label":e.muted?"Unmute":"Mute",ref:a},l("span",{className:o(n.icon,!0===e.muted?n.muted:n.unmuted)}))),xe=h((e,a)=>{var t;const{handleShareClick:r,linkCopied:u}=le({shareData:e.share,customEventData:e.customEventData});return l("button",{onClick:r,"aria-label":"Share this video",className:o({[n.active]:u,[n.centerTooltip]:"center"===(null==(t=e.share)?void 0:t.confirmationPosition)}),ref:a},l("span",{className:o(n.icon,n.link)}))}),Oe=h((e,a)=>l("div",{className:o(n.container,{[n.noClickContainer]:(null==e?void 0:e.overlayClickBehavior)===T.None,[n.hide]:e.hide}),onClick:e.onClick,ref:a,"data-testid":e.testId},e.children));function Ae(e){return l("div",{className:o(n.controls,e.classes)},e.children)}function je(e){return l("div",{className:o(n.playButtonContainer,{[n.paused]:"paused"===e.playState})},l("button",{"aria-label":"paused"===e.playState?"Play":"Pause",onClick:e.onTogglePlaystate,className:n.playButton,"aria-pressed":"playing"===e.playState},l("div",{className:o(n.playButtonInner,{[n.paused]:"paused"===e.playState})},l("span",{className:o(n.icon,"paused"===e.playState?n.play:n.pause)}))),e.children)}function Ve(e){return l("div",{className:n.duration,"data-testid":"betamax-overlay-controls-duration"},$(e.duration))}var T=(e=>(e.Controlled="controlled",e.FirstUnmuteThenPause="first-unmute-then-pause",e.MuteUnmute="mute-unmute",e.None="none",e.PlayPause="play-pause",e))(T||{});function qe(e){return"not-supported"===e?"Fullscreen video is not supported":!1===e?"Make video fullscreen":"Exit fullscreen"}function Je({overlayClickBehavior:e,controls:a,share:t,showDuration:r,onTranscriptClick:u,disableScrubbing:s,onOverlayInteraction:i,onScrubEnd:d,onScrubStart:p}){var _,v;const m=null==(_=W("nyt-betamax"))?void 0:_.player;if(!m)throw new Error("Could not get player context. Is this rendering inside a betamax component?");const f=null!==ne().value,b=c(null),x=c(null),h=c(null),k=c(null),C=c(null),[S,g]=X(!1),E=!a||a.includes("scrubber"),N=ae(),P=!a||a.includes("play"),B=m.autoplayBlocked.value??!1,F=!f&&(P||B)&&("mute-unmute"!==e||!0===N.value||((null==(v=m.autoplayBlocked)?void 0:v.value)??!1));Y(()=>{const e=m.fullscreen.subscribe(e=>{var n,l;!0===e&&!1===C.current?null==(n=m.tracking)||n.send(y.EnterFullscreen):!1===e&&!0===C.current&&(null==(l=m.tracking)||l.send(y.ExitFullscreen)),"not-supported"!==e&&(C.current=e)});return()=>{e()}},[m.fullscreen,m.tracking]);const T=R(()=>{g(!0),null==p||p()},[p]),M=R(()=>{g(!1),null==d||d()},[d]);function j(){const e=Object.values(U);for(const n of e)if(n){const e=n.ref;if(null!=e&&e.current)return e.current}return null}function D(e){var n;null==e||e.stopPropagation(),!S&&("paused"===(null==m?void 0:m.playState.value)?(null==m||m.play(),null==(n=j())||n.focus({preventScroll:!0})):!0!==(null==m?void 0:m.muted.value)||e instanceof PointerEvent&&0===e.detail?null==m||m.pause():null==m||m.setMuted(!1))}function w(e){i?m&&i(e,{state:{playState:m.playState.value,muted:m.muted.value},actions:{play:()=>m.play(),pause:()=>m.pause(),setMuted:e=>m.setMuted(e)}}):console.error("no interaction overlay provided")}function I(e){null==m||m.setMuted(!(null!=m&&m.muted.value)),null==e||e.stopPropagation()}te({containerRef:b,playState:m.playState,setUserDrivenPlaystate:(n,l)=>{var a;switch(e){case"mute-unmute":return;case"controlled":return void w(l);default:"play"===n?(m.play(),null==(a=j())||a.focus({preventScroll:!0})):m.pause()}}});const U={fullscreen:l("button",{onClick:function(e){"not-supported"!==(null==m?void 0:m.fullscreen.value)&&(null==m||m.setFullscreen(!(null!=m&&m.fullscreen.value)),e.stopPropagation())},"aria-label":qe(m.fullscreen.value),disabled:"not-supported"===m.fullscreen.value,ref:h},l("span",{className:o(n.icon,!0===m.fullscreen.value?n.fullscreenExit:n.fullscreen)})),mute:l(Ue,{muted:m.muted.value,onClick:I,ref:x}),share:t?l(xe,{share:t,ref:k}):null,transcript:u?l("button",{onClick:function(e){e.stopPropagation(),u&&(!0===(null==m?void 0:m.fullscreen.value)?null==m||m.setFullscreen(!1).then(u):u())},"aria-label":"Show transcript"},l("span",{className:o(n.icon,n.transcript)})):null,captions:l("button",{disabled:!m.captionsAvailable.value,onClick:function(e){var n;null==e||e.stopPropagation(),null==m||m.setCaptions(!(null!=m&&m.captions.value)),null==(n=null==m?void 0:m.tracking)||n.send(null!=m&&m.captions.value?y.EnterCaptions:y.ExitCaptions)},"aria-label":"Toggle closed captions"},l("span",{className:o(n.icon,!0===m.captions.value?n.captionsFilled:n.captions)}))};return l(Oe,{overlayClickBehavior:e,ref:b,onClick:function(n){if(!S&&!f&&m)if(!0!==N.value||"paused"!==(null==m?void 0:m.playState.value))switch(e){case"mute-unmute":I(n);break;case"play-pause":l();break;case"controlled":w(n);break;default:D(n)}else l();function l(){"paused"===(null==m?void 0:m.playState.value)?null==m||m.play():null==m||m.pause()}},testId:"betamax-overlay-controls",hide:m.hasEndSlate.value&&m.videoEnded.value},F&&l(je,{onTogglePlaystate:"controlled"===e?w:D,playState:m.playState.value},r&&!m.hasEverPlayed.value&&!!m.duration.value&&l(Ve,{duration:m.duration.value})),m.hasEverPlayed.value&&l(Z,null,l(Ae,{classes:o({[n.verticalVideoControls]:m.aspectRatio.value<=1,[n.invisibleFade]:S})},a?a.map(e=>U[e]):Object.values(U)),E?l(ee,{onScrubEnd:M,onScrubStart:T,disableScrubbing:f||s}):null))}const Xe=Q("nyt-betamax-overlay-controls",{"css":["https://static01.nyt.com/video-static/betamax/overlay-controls-0.1.66-CTwbQZQR.css","https://static01.nyt.com/video-static/betamax/scrubber-0.1.66-CvF-F_iX.css"],"js":[{"src":"https://static01.nyt.com/video-static/betamax/overlay-controls-CXE2R2RA.js","entry":true},{"src":"https://static01.nyt.com/video-static/betamax/betamax-shared-CtfXo_g9.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/scrubber-Fc2JH2_k.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/signal-utils-C9exRBko.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/event-types-CFKw-uz_.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/keyboard-controls-C1fzEZi7.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/reduced-motion-BAaHUNZW.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/index-B-FVqW3A.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/identify-user-NlIHKxju.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/intersection-observer-CkRdJA_t.js","entry":false},{"src":"https://static01.nyt.com/video-static/betamax/use-share-3HiF_dHL.js","entry":false}]},Je);export{Ae as C,Ue as M,T as O,je as P,xe as S,Oe as a,Xe as b,n as o};
//# sourceMappingURL=overlay-controls-CXE2R2RA.js.map